<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aethrix | ä»¥å¤ªå¤œ - AI å·¥å…·å¯¼èˆªå¹³å°ï¼Œèšåˆæœ€æ–°AIå·¥å…·ã€å¤§è¯­è¨€æ¨¡å‹ã€å·¥ä½œæµå¹³å°ç­‰èµ„æº">
    <meta name="keywords" content="AIå·¥å…·,å¤§è¯­è¨€æ¨¡å‹,ChatGPT,Claude,å·¥ä½œæµ,æ–‡ç”Ÿå›¾,æ–‡ç”Ÿè§†é¢‘,Aethrix,ä»¥å¤ªå¤œ">
    <title>AI å·¥å…·å¹³å° Â· Aethrix | ä»¥å¤ªå¤œ</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="alternate icon" href="/favicon.ico">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Aethrix">

    <link rel="stylesheet" href="style.css?v=2026011415">

    <!-- é˜²æ­¢é—ªå±ï¼šåœ¨è®¤è¯æ£€æŸ¥å®Œæˆå‰éšè—é¡µé¢ -->
    <style id="auth-loading-style">
        body {
            visibility: hidden;
        }
    </style>

    <!-- Aethrix åŠ©æ‰‹åŠ¨ç”» -->
    <style>
        @keyframes aethrix-pulse-glow {
            0% {
                opacity: 0.6;
                transform: scale(1);
            }

            50% {
                opacity: 0.3;
                transform: scale(1.1);
            }

            100% {
                opacity: 0;
                transform: scale(1.2);
            }
        }
    </style>

    <!-- æœ€æ—©çš„è®¤è¯æ£€æŸ¥ï¼šåœ¨ä»»ä½•å…¶ä»–è„šæœ¬ä¹‹å‰æ‰§è¡Œ -->
    <script>
        // åŒæ­¥æ£€æŸ¥ localStorageï¼Œå¦‚æœæ²¡æœ‰è®¤è¯çŠ¶æ€ç«‹å³è·³è½¬
        // æ”¯æŒ Firebase ç™»å½•å’Œ GitHub OAuth ç›´æ¥ç™»å½•ä¸¤ç§æ–¹å¼
        (function () {
            var storedAuth = localStorage.getItem('firebase_auth_state');
            var githubAuth = localStorage.getItem('github_auth_state');
            var authState = null;
            var authType = null;  // ä¼˜å…ˆæ£€æŸ¥ Firebase è®¤è¯
            if (storedAuth) {
                try {
                    authState = JSON.parse(storedAuth);
                    authType = 'firebase';
                } catch (e) {
                    localStorage.removeItem('firebase_auth_state');
                }
            }

            // å¦‚æœæ²¡æœ‰ Firebase è®¤è¯ï¼Œæ£€æŸ¥ GitHub OAuth è®¤è¯
            if (!authState && githubAuth) {
                try {
                    authState = JSON.parse(githubAuth);
                    authType = 'github';
                } catch (e) {
                    localStorage.removeItem('github_auth_state');
                }
            }

            // æ²¡æœ‰å­˜å‚¨çš„è®¤è¯çŠ¶æ€ï¼Œç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µ
            if (!authState) {
                window.location.replace('/auth.html?returnUrl=/tools.html');
                return;
            }

            // æ£€æŸ¥ token æ˜¯å¦è¿‡æœŸï¼ˆ1å°æ—¶å†…æœ‰æ•ˆï¼‰
            var tokenAge = Date.now() - (authState.timestamp || 0);
            if (!authState.uid || tokenAge >= 60 * 60 * 1000) {
                localStorage.removeItem('firebase_auth_state');
                localStorage.removeItem('github_auth_state');
                window.location.replace('/auth.html?returnUrl=/tools.html');
                return;
            }

            // æœ‰æœ‰æ•ˆçš„è®¤è¯çŠ¶æ€ï¼Œä¿å­˜è®¤è¯ç±»å‹ä¾›åç»­ä½¿ç”¨
            window._authType = authType;
            window._authState = authState;
            // æ˜¾ç¤ºé¡µé¢
            document.getElementById('auth-loading-style').remove();
        })();
    </script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <!-- Firebase Modules -->
    <script src="js/firebase/firebaseConfig.js"></script>
    <script src="js/firebase/authStateManager.js"></script>

    <!-- Login Check - Use Firebase with backend fallback -->
    <script>
        (async function checkAuth() {
            // ä½¿ç”¨ä¹‹å‰åŒæ­¥è„šæœ¬ä¸­å·²éªŒè¯çš„è®¤è¯çŠ¶æ€
            var authState = window._authState;
            var authType = window._authType;

            if (authState) {
                console.log('è®¤è¯çŠ¶æ€: ', authState.email || authState.displayName, 'ç±»å‹: ', authType);
                // è®¾ç½® window.currentUser ä»¥ä¾¿é¡µé¢ä½¿ç”¨
                window.currentUser = {
                    uid: authState.uid,
                    email: authState.email,
                    displayName: authState.displayName,
                    photoURL: authState.photoURL,
                    nickname: authState.displayName || (authState.email ? authState.email.split('@')[0] : 'User'),
                    isAdmin: false, // ç¨åä»åç«¯è·å–
                    provider: authType
                };

                // å¦‚æœæ˜¯ Firebase ç™»å½•ï¼Œåå°åˆå§‹åŒ– Firebase
                if (authType === 'firebase') {
                    initFirebaseInBackground();
                }
                return;
            }

            // å¦‚æœåˆ°è¿™é‡Œè¯´æ˜æ²¡æœ‰æœ‰æ•ˆçš„å­˜å‚¨çŠ¶æ€ï¼ˆç†è®ºä¸Šä¸åº”è¯¥åˆ°è¿™é‡Œï¼Œå› ä¸ºä¸Šé¢çš„åŒæ­¥è„šæœ¬ä¼šè·³è½¬ï¼‰
            try {
                window.location.replace('/auth.html?returnUrl=/tools.html');
            } catch (error) {
                console.error('Auth check error:', error);
                window.location.replace('/auth.html?returnUrl=/tools.html');
            }
        })();

        // åå°åˆå§‹åŒ– Firebase å¹¶åŒæ­¥ç”¨æˆ·çŠ¶æ€
        async function initFirebaseInBackground() {
            try {
                const app = window.FirebaseConfig && window.FirebaseConfig.initializeFirebase();
                if (app && window.FirebaseConfig.isConfigured() && window.AuthStateManager) {
                    const user = await window.AuthStateManager.waitForAuthReady(3000);
                    if (user) {
                        syncUserToBackend(user);
                    } else {
                        // Firebase ç¡®è®¤ç”¨æˆ·å·²ç™»å‡ºï¼Œæ¸…é™¤æœ¬åœ°å­˜å‚¨å¹¶è·³è½¬åˆ°ç™»å½•é¡µ
                        console.log('Firebase ç¡®è®¤ç”¨æˆ·å·²ç™»å‡ºï¼Œè·³è½¬åˆ°ç™»å½•é¡µ');
                        if (window.AuthStateManager.clearAuthState) {
                            window.AuthStateManager.clearAuthState();
                        }
                        localStorage.removeItem('firebase_auth_state');
                        window.location.replace('/auth.html?returnUrl=/tools.html');
                    }
                }
            } catch (e) {
                console.log('åå° Firebase åˆå§‹åŒ–å¤±è´¥:', e);
            }
        }

        // åŒæ­¥ç”¨æˆ·åˆ°åç«¯
        async function syncUserToBackend(user) {
            try {
                const idToken = await user.getIdToken();
                const syncResponse = await fetch('/api/auth/firebase-sync', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${idToken}`
                    },
                    body: JSON.stringify({
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName,
                        photoURL: user.photoURL,
                        provider: user.providerData[0]?.providerId || 'password'
                    })
                });

                if (syncResponse.ok) {
                    const syncData = await syncResponse.json();
                    if (syncData.user) {
                        window.currentUser.isAdmin = syncData.user?.isAdmin || false;
                        window.currentUser.nickname = syncData.user?.nickname || user.displayName || user.email?.split('@')[0];

                        // ğŸ”¥ åŒæ­¥å®Œæˆåï¼Œæ›´æ–°ç®¡ç†å‘˜æŒ‰é’®æ˜¾ç¤º
                        const adminBtn = document.getElementById('tools-admin-btn');
                        if (adminBtn && window.currentUser.isAdmin) {
                            adminBtn.style.display = 'flex';
                            console.log('ç®¡ç†å‘˜æŒ‰é’®å·²æ˜¾ç¤ºï¼ˆtoolsé¡µé¢ - syncUserToBackendï¼‰');
                        }
                    }
                }
            } catch (syncError) {
                console.log('åŒæ­¥ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', syncError);
            }
        }
    </script>
    <!-- Early theme initialization to prevent flash -->
    <!-- Theme initialization handled by theme-manager.js -->
</head>

<body class="tools-page" data-theme="light">
    <a href="#main-content" class="sr-only skip-link">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>

    <!-- Site Header -->
    <header class="site-header" role="banner">
        <div class="logo">
            <a href="/" class="logo-link" aria-label="è¿”å›é¦–é¡µ">
                <span class="logo-text">Aethrix | ä»¥å¤ªå¤œ</span>
                <span class="logo-line" aria-hidden="true"></span>
            </a>
        </div>

        <nav class="header-actions" aria-label="å¿«æ·æ“ä½œ">
            <!-- Admin Panel Button (ä»…ç®¡ç†å‘˜å¯è§) -->
            <button class="theme-toggle-circle" id="tools-admin-btn" aria-label="ç®¡ç†å‘˜åå°" title="è¿›å…¥ç®¡ç†å‘˜åå°" type="button"
                style="display: none;" onclick="window.location.href='/admin.html'">
                <svg class="theme-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    aria-hidden="true" focusable="false">
                    <path d="M12 2L2 7l10 5 10-5-10-5z" />
                    <polyline points="2 17 12 22 22 17" />
                    <polyline points="2 12 12 17 22 12" />
                </svg>
            </button>
            <!-- Theme Toggle Button - Circular Design -->
            <button class="theme-toggle-circle" id="tools-theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜" title="åˆ‡æ¢ç™½å¤©/å¤œæ™šæ¨¡å¼"
                role="switch" aria-checked="true" type="button">
                <svg class="theme-icon theme-icon--sun" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" aria-hidden="true" focusable="false">
                    <circle cx="12" cy="12" r="5" />
                    <line x1="12" y1="1" x2="12" y2="3" />
                    <line x1="12" y1="21" x2="12" y2="23" />
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                    <line x1="1" y1="12" x2="3" y2="12" />
                    <line x1="21" y1="12" x2="23" y2="12" />
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                </svg>
                <svg class="theme-icon theme-icon--moon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" aria-hidden="true" focusable="false">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
            </button>
            <a href="/" class="header-icon" aria-label="è¿”å›é¦–é¡µ" title="è¿”å›é¦–é¡µ">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                    <polyline points="9 22 9 12 15 12 15 22" />
                </svg>
            </a>
            <!-- Auth Icon / User Avatar -->
            <a href="auth.html" class="header-icon" aria-label="ç™»å½•" title="ç™»å½•" id="auth-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </a>
            <div class="user-avatar user-avatar--small" id="user-avatar" style="display: none;"
                onclick="toggleProfilePopup()">
                <span class="avatar-text" id="avatar-text"></span>
            </div>
            <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="åˆ‡æ¢å¯¼èˆªèœå•" aria-expanded="false"
                aria-controls="side-nav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </button>
        </nav>
    </header>

    <!-- User Profile Popup -->
    <div class="profile-popup" id="profile-popup" style="display: none;">
        <div class="profile-popup-header">
            <h3>ä¸ªäººä¿¡æ¯</h3>
            <button class="profile-popup-close" onclick="closeProfilePopup()" aria-label="å…³é—­">Ã—</button>
        </div>
        <!-- Success/Error Message -->
        <div id="profile-message"
            style="display: none; padding: 10px 16px; margin: 0 16px; border-radius: 6px; font-size: 13px; text-align: center;">
        </div>
        <div class="profile-popup-content" id="profile-view-mode">
            <div class="profile-field">
                <label>æ˜µç§°</label>
                <span id="profile-nickname">-</span>
            </div>
            <div class="profile-field">
                <label>é‚®ç®±</label>
                <span id="profile-email">-</span>
            </div>
        </div>
        <!-- Edit Mode -->
        <div class="profile-popup-content" id="profile-edit-mode" style="display: none;">
            <div class="profile-field">
                <label for="edit-nickname">æ˜µç§°</label>
                <input type="text" class="form-input" id="edit-nickname" placeholder="è¯·è¾“å…¥æ–°æ˜µç§°" minlength="2"
                    maxlength="20">
            </div>
            <div class="profile-field">
                <label>é‚®ç®±</label>
                <span id="edit-email" style="color: #666;">-</span>
                <small style="color: #999; font-size: 11px;">é‚®ç®±ä¸å¯ä¿®æ”¹</small>
            </div>
            <div id="edit-error" style="color: #e53935; font-size: 12px; margin-top: 8px;"></div>
        </div>
        <div class="profile-popup-footer">
            <div id="profile-view-buttons">
                <button class="btn btn--outline btn--sm" onclick="enterEditMode()"
                    style="margin-right: 8px;">ä¿®æ”¹ä¿¡æ¯</button>
                <button class="btn btn--outline btn--sm" onclick="handleLogout()">é€€å‡ºç™»å½•</button>
            </div>
            <div id="profile-edit-buttons" style="display: none;">
                <button class="btn btn--primary btn--sm" onclick="saveProfileChanges()"
                    style="margin-right: 8px;">ä¿å­˜</button>
                <button class="btn btn--outline btn--sm" onclick="cancelEditMode()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div class="mobile-overlay" id="mobile-overlay" aria-hidden="true"></div>

    <!-- Side Navigation -->
    <nav class="side-nav" id="side-nav" role="navigation" aria-label="å·¥å…·åˆ†ç±»å¯¼èˆª">
        <!-- AI å·¥å…·å¹³å° (å¸¦å­èœå•) -->
        <button class="nav-item has-submenu expanded" id="ai-tools-nav" aria-expanded="true"
            aria-controls="ai-tools-submenu">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="3" />
                    <path
                        d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                </svg>
            </div>
            <span>AI å·¥å…·å¹³å°</span>
            <span class="nav-item-arrow" aria-hidden="true">
                <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9" />
                </svg>
            </span>
            <!-- Submenu popup for collapsed state - icon grid with tooltips -->
            <div class="nav-submenu-popup">
                <div class="submenu-popup-header">AI å·¥å…·å¹³å°</div>
                <div class="submenu-popup-grid">
                    <a href="#llm" class="submenu-popup-item" data-section="llm">
                        <svg viewBox="0 0 24 24">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                        </svg>
                        <span class="submenu-tooltip">å¤§è¯­è¨€æ¨¡å‹</span>
                    </a>
                    <a href="#workflow" class="submenu-popup-item" data-section="workflow">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                        </svg>
                        <span class="submenu-tooltip">å·¥ä½œæµå¹³å°</span>
                    </a>
                    <a href="#txt2img" class="submenu-popup-item" data-section="txt2img">
                        <svg viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <path d="M21 15l-5-5L5 21" />
                        </svg>
                        <span class="submenu-tooltip">æ–‡ç”Ÿå›¾</span>
                    </a>
                    <a href="#txt2vid" class="submenu-popup-item" data-section="txt2vid">
                        <svg viewBox="0 0 24 24">
                            <rect x="2" y="2" width="20" height="20" rx="2.18" />
                            <path d="M10 8l6 4-6 4V8z" />
                        </svg>
                        <span class="submenu-tooltip">æ–‡ç”Ÿè§†é¢‘</span>
                    </a>
                    <a href="#img2x" class="submenu-popup-item" data-section="img2x">
                        <svg viewBox="0 0 24 24">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <path d="M14 2v6h6M12 18v-6M9 15h6" />
                        </svg>
                        <span class="submenu-tooltip">å›¾ç”Ÿå›¾/è§†é¢‘</span>
                    </a>
                    <a href="#onestop" class="submenu-popup-item" data-section="onestop">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                        </svg>
                        <span class="submenu-tooltip">ä¸€ç«™å¼AI</span>
                    </a>
                    <a href="#design" class="submenu-popup-item" data-section="design">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 19l7-7 3 3-7 7-3-3z" />
                            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
                            <path d="M2 2l7.586 7.586" />
                            <circle cx="11" cy="11" r="2" />
                        </svg>
                        <span class="submenu-tooltip">è®¾è®¡(UI/Logo)</span>
                    </a>
                    <a href="#marketing" class="submenu-popup-item" data-section="marketing">
                        <svg viewBox="0 0 24 24">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z" />
                            <line x1="3" y1="6" x2="21" y2="6" />
                            <path d="M16 10a4 4 0 0 1-8 0" />
                        </svg>
                        <span class="submenu-tooltip">å¸‚åœºè¥é”€/ç”µå•†</span>
                    </a>
                    <a href="#coding" class="submenu-popup-item" data-section="coding">
                        <svg viewBox="0 0 24 24">
                            <polyline points="16 18 22 12 16 6" />
                            <polyline points="8 6 2 12 8 18" />
                        </svg>
                        <span class="submenu-tooltip">ç¼–ç¨‹/è¿ç»´</span>
                    </a>
                    <a href="#crawler" class="submenu-popup-item" data-section="crawler">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8" />
                            <path d="M21 21l-4.35-4.35" />
                        </svg>
                        <span class="submenu-tooltip">çˆ¬è™«/OSINT</span>
                    </a>
                    <a href="#data" class="submenu-popup-item" data-section="data">
                        <svg viewBox="0 0 24 24">
                            <path d="M18 20V10" />
                            <path d="M12 20V4" />
                            <path d="M6 20v-6" />
                        </svg>
                        <span class="submenu-tooltip">æ•°æ®åˆ†æ</span>
                    </a>
                    <a href="#voice" class="submenu-popup-item" data-section="voice">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                            <line x1="12" y1="19" x2="12" y2="23" />
                            <line x1="8" y1="23" x2="16" y2="23" />
                        </svg>
                        <span class="submenu-tooltip">å£°éŸ³å…‹éš†/TTS</span>
                    </a>
                    <a href="#3d" class="submenu-popup-item" data-section="3d">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
                            <line x1="12" y1="22.08" x2="12" y2="12" />
                        </svg>
                        <span class="submenu-tooltip">Ai 3Då»ºæ¨¡</span>
                    </a>
                    <a href="#frontend" class="submenu-popup-item" data-section="frontend">
                        <svg viewBox="0 0 24 24">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                        </svg>
                        <span class="submenu-tooltip">å‰ç«¯èµ„æºåº“</span>
                    </a>
                    <a href="#academic" class="submenu-popup-item" data-section="academic">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 10v6M2 10l10-5 10 5-10 5z" />
                            <path d="M6 12v5c3 3 9 3 12 0v-5" />
                        </svg>
                        <span class="submenu-tooltip">å­¦æœ¯è®ºæ–‡</span>
                    </a>
                    <a href="#solopreneur" class="submenu-popup-item" data-section="solopreneur">
                        <svg viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                            <circle cx="12" cy="7" r="4" />
                        </svg>
                        <span class="submenu-tooltip">ä¸€äººå…¬å¸</span>
                    </a>
                </div>
            </div>
        </button>
        <ul class="submenu expanded" id="ai-tools-submenu" role="menu" aria-label="AIå·¥å…·å­åˆ†ç±»">
            <li role="none"><a href="#llm" class="submenu-item active" role="menuitem" data-section="llm">å¤§è¯­è¨€æ¨¡å‹</a></li>
            <li role="none"><a href="#workflow" class="submenu-item" role="menuitem" data-section="workflow">å·¥ä½œæµå¹³å°</a>
            </li>
            <li role="none"><a href="#txt2img" class="submenu-item" role="menuitem" data-section="txt2img">æ–‡ç”Ÿå›¾</a></li>
            <li role="none"><a href="#txt2vid" class="submenu-item" role="menuitem" data-section="txt2vid">æ–‡ç”Ÿè§†é¢‘</a></li>
            <li role="none"><a href="#img2x" class="submenu-item" role="menuitem" data-section="img2x">å›¾ç”Ÿå›¾/è§†é¢‘</a></li>
            <li role="none"><a href="#onestop" class="submenu-item" role="menuitem" data-section="onestop">ä¸€ç«™å¼AI</a>
            </li>
            <li role="none"><a href="#design" class="submenu-item" role="menuitem" data-section="design">è®¾è®¡(UI/Logo)</a>
            </li>
            <li role="none"><a href="#marketing" class="submenu-item" role="menuitem"
                    data-section="marketing">å¸‚åœºè¥é”€/ç”µå•†</a></li>
            <li role="none"><a href="#coding" class="submenu-item" role="menuitem" data-section="coding">ç¼–ç¨‹/è¿ç»´</a></li>
            <li role="none"><a href="#crawler" class="submenu-item" role="menuitem" data-section="crawler">çˆ¬è™«/OSINT</a>
            </li>
            <li role="none"><a href="#data" class="submenu-item" role="menuitem" data-section="data">æ•°æ®åˆ†æ</a></li>
            <li role="none"><a href="#voice" class="submenu-item" role="menuitem" data-section="voice">å£°éŸ³å…‹éš†/TTS</a></li>
            <li role="none"><a href="#3d" class="submenu-item" role="menuitem" data-section="3d">Ai 3Då»ºæ¨¡</a></li>
            <li role="none"><a href="#frontend" class="submenu-item" role="menuitem" data-section="frontend">å‰ç«¯èµ„æºåº“</a>
            </li>
            <li role="none"><a href="#academic" class="submenu-item" role="menuitem" data-section="academic">å­¦æœ¯è®ºæ–‡</a>
            </li>
            <li role="none"><a href="#solopreneur" class="submenu-item" role="menuitem"
                    data-section="solopreneur">ä¸€äººå…¬å¸</a></li>
        </ul>

        <!-- å…¶ä»–ä¸»å¯¼èˆª -->
        <a href="#workshop" class="nav-item" role="menuitem" data-section="workshop">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
                </svg>
            </div>
            <span>AI å¼€å‘å·¥åŠ</span>
            <span class="nav-tooltip">AI å¼€å‘å·¥åŠ</span>
        </a>
        <a href="#tutorials" class="nav-item" role="menuitem" data-section="tutorials">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                </svg>
            </div>
            <span>æ•™ç¨‹ / æ¡ˆä¾‹</span>
            <span class="nav-tooltip">æ•™ç¨‹ / æ¡ˆä¾‹</span>
        </a>
        <a href="#apis" class="nav-item" role="menuitem" data-section="apis">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path d="M18 20V10" />
                    <path d="M12 20V4" />
                    <path d="M6 20v-6" />
                </svg>
            </div>
            <span>API é›†åˆ</span>
            <span class="nav-tooltip">API é›†åˆ</span>
        </a>
        <a href="#trends" class="nav-item" role="menuitem" data-section="trends">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                    <polyline points="17 6 23 6 23 12" />
                </svg>
            </div>
            <span>çƒ­ç‚¹è¶‹åŠ¿</span>
            <span class="nav-tooltip">çƒ­ç‚¹è¶‹åŠ¿</span>
        </a>

        <hr class="nav-divider" aria-hidden="true">

        <a href="#solo" class="nav-item" role="menuitem" data-section="solo">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </div>
            <span>ä¸€äººå…¬å¸</span>
            <span class="nav-tooltip">ä¸€äººå…¬å¸</span>
        </a>
        <a href="#ai-ranking" class="nav-item" role="menuitem" data-section="ai-ranking">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" />
                </svg>
            </div>
            <span>AIæ’è¡Œæ¦œ</span>
            <span class="nav-tooltip">AIæ’è¡Œæ¦œ</span>
        </a>
        <a href="#thoughts" class="nav-item" role="menuitem" data-section="thoughts">
            <div class="nav-icon-wrapper">
                <svg viewBox="0 0 24 24">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
            </div>
            <span>åŒ¿åæ€æƒ³å¢™</span>
            <span class="nav-tooltip">åŒ¿åæ€æƒ³å¢™</span>
        </a>
    </nav>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebar-toggle" aria-label="æŠ˜å /å±•å¼€ä¾§è¾¹æ " title="æŠ˜å /å±•å¼€ä¾§è¾¹æ ">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6" />
        </svg>
    </button>

    <div id="aria-live-region" class="aria-live-region" aria-live="polite" aria-atomic="true"></div>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content" role="main">
        <header class="content-header">
            <h1 class="content-title" id="page-title" aria-live="polite">AI å·¥å…·å¯¼èˆª</h1>
            <p class="content-subtitle">ä¸€äººæ‰“é€ çš„ AI å·¥å…·å¯¼èˆªä¸è‡ªå»ºç”Ÿæ€</p>
        </header>

        <div class="tools-container">
            <!-- Dynamic AI Tool Sections - Will be populated by JavaScript -->
            <div id="ai-tools-container">
                <!-- Loading state -->
                <div class="tools-loading" id="tools-loading">
                    <div class="loading-spinner"></div>
                    <p>æ­£åœ¨åŠ è½½å·¥å…·...</p>
                </div>
            </div>

            <!-- Static Sections Below -->

            <!-- AI å¼€å‘å·¥åŠ Section -->
            <section class="tool-section" id="workshop" aria-labelledby="workshop-title">
                <h2 class="section-title" id="workshop-title">AI å¼€å‘å·¥åŠ</h2>
                <p class="section-description">å·¥ä½œæµã€æ™ºèƒ½ä½“ã€ç»„ä»¶åº“ä¸æç¤ºè¯èµ„æº</p>

                <!-- Tab Navigation -->
                <div class="workshop-tabs">
                    <button class="workshop-tab active" data-tab="n8n-list"
                        onclick="window.switchWorkshopTab('n8n-list')">n8n å·¥ä½œæµ</button>
                    <button class="workshop-tab" data-tab="dify-list"
                        onclick="window.switchWorkshopTab('dify-list')">Dify åº”ç”¨</button>
                    <button class="workshop-tab" data-tab="coze-list"
                        onclick="window.switchWorkshopTab('coze-list')">Coze æ™ºèƒ½ä½“</button>
                    <button class="workshop-tab" data-tab="skill-list"
                        onclick="window.switchWorkshopTab('skill-list')">Skill ç»„ä»¶åº“</button>
                    <button class="workshop-tab" data-tab="prompt-list"
                        onclick="window.switchWorkshopTab('prompt-list')">æç¤ºè¯å·¥åŠ</button>
                </div>

                <!-- n8n å·¥ä½œæµ -->
                <div id="n8n-list" class="workshop-tab-content active" style="display: block;">
                    <div class="workshop-more-links" id="n8n-more-link" style="display: none;">
                        <!-- Links will be dynamically rendered -->
                    </div>
                    <div class="tool-grid" id="n8n-grid">
                        <p class="empty-text">æš‚æ—  n8n å·¥ä½œæµï¼Œæ•¬è¯·æœŸå¾…...</p>
                    </div>
                </div>

                <!-- Dify åº”ç”¨ -->
                <div id="dify-list" class="workshop-tab-content">
                    <div class="workshop-more-links" id="dify-more-link" style="display: none;">
                        <!-- Links will be dynamically rendered -->
                    </div>
                    <div class="tool-grid" id="dify-grid">
                        <p class="empty-text">æš‚æ—  Dify åº”ç”¨ï¼Œæ•¬è¯·æœŸå¾…...</p>
                    </div>
                </div>

                <!-- Coze æ™ºèƒ½ä½“ -->
                <div id="coze-list" class="workshop-tab-content">
                    <div class="workshop-more-links" id="coze-more-link" style="display: none;">
                        <!-- Links will be dynamically rendered -->
                    </div>
                    <div class="tool-grid" id="coze-grid">
                        <p class="empty-text">æš‚æ—  Coze æ™ºèƒ½ä½“ï¼Œæ•¬è¯·æœŸå¾…...</p>
                    </div>
                </div>

                <!-- Skill ç»„ä»¶åº“ -->
                <div id="skill-list" class="workshop-tab-content">
                    <div class="workshop-more-links" id="skill-more-link" style="display: none;">
                        <!-- Links will be dynamically rendered -->
                    </div>
                    <div class="tool-grid" id="skill-grid">
                        <p class="empty-text">æš‚æ—  Skill ç»„ä»¶ï¼Œæ•¬è¯·æœŸå¾…...</p>
                    </div>
                </div>

                <!-- æç¤ºè¯å·¥åŠ -->
                <div id="prompt-list" class="workshop-tab-content">
                    <div class="workshop-more-links" id="prompt-more-link"
                        style="display: flex; justify-content: center; margin-bottom: 16px;">
                        <a href="https://prompt.cdproveai.com/" target="_blank" class="workshop-more-btn">
                            æŸ¥çœ‹æ›´å¤šç²¾é€‰
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                <polyline points="15 3 21 3 21 9"></polyline>
                                <line x1="10" y1="14" x2="21" y2="3"></line>
                            </svg>
                        </a>
                    </div>
                    <p class="more-link-desc"
                        style="text-align: center; color: #9ca3af; font-size: 12px; margin-bottom: 24px;">ç²¾é€‰ AI æç¤ºè¯å·¥å…·é›†
                    </p>

                    <div class="tool-grid" id="prompt-grid">
                        <!-- PromptHero -->
                        <article class="workshop-card" data-delay="1">
                            <div class="workshop-card-content">
                                <h3 class="workshop-card-title">PromptHero</h3>
                                <p class="workshop-card-description">æœ€å¤§çš„ AI æç¤ºè¯æœç´¢å¼•æ“ï¼Œæ¶µç›– MJ, SD, DALL-E</p>
                                <div class="workshop-card-tags">
                                    <span class="workshop-tag">å…è´¹</span>
                                    <span class="workshop-tag">æç¤ºè¯æœç´¢</span>
                                </div>
                            </div>
                            <div class="workshop-card-actions">
                                <a href="https://prompthero.com/" target="_blank" class="workshop-action-btn">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.35-4.35"></path>
                                    </svg>
                                    æŸ¥çœ‹è¯¦æƒ…
                                </a>
                            </div>
                        </article>

                        <!-- FlowGPT -->
                        <article class="workshop-card" data-delay="2">
                            <div class="workshop-card-content">
                                <h3 class="workshop-card-title">FlowGPT</h3>
                                <p class="workshop-card-description">å…¨çƒæœ€å¤§çš„ ChatGPT æç¤ºè¯åˆ†äº«ç¤¾åŒº</p>
                                <div class="workshop-card-tags">
                                    <span class="workshop-tag">å…è´¹</span>
                                    <span class="workshop-tag">ç¤¾åŒº</span>
                                </div>
                            </div>
                            <div class="workshop-card-actions">
                                <a href="https://flowgpt.com/" target="_blank" class="workshop-action-btn">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.35-4.35"></path>
                                    </svg>
                                    æŸ¥çœ‹è¯¦æƒ…
                                </a>
                            </div>
                        </article>

                        <!-- Prompt Optimizer -->
                        <article class="workshop-card" data-delay="3">
                            <div class="workshop-card-content">
                                <h3 class="workshop-card-title">Prompt Optimizer</h3>
                                <p class="workshop-card-description">AI æ™ºèƒ½ä¼˜åŒ–æç¤ºè¯ï¼Œæ”¯æŒå¤šæ¨¡å‹é›†æˆ</p>
                                <div class="workshop-card-tags">
                                    <span class="workshop-tag">å¼€æº</span>
                                    <span class="workshop-tag">ä¼˜åŒ–å·¥å…·</span>
                                </div>
                            </div>
                            <div class="workshop-card-actions">
                                <a href="https://github.com/linshenkx/prompt-optimizer" target="_blank"
                                    class="workshop-action-btn">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.35-4.35"></path>
                                    </svg>
                                    æŸ¥çœ‹è¯¦æƒ…
                                </a>
                            </div>
                        </article>

                        <!-- Learn Prompting -->
                        <article class="workshop-card" data-delay="4">
                            <div class="workshop-card-content">
                                <h3 class="workshop-card-title">Learn Prompting</h3>
                                <p class="workshop-card-description">æœ€æƒå¨çš„å…è´¹å¼€æºæç¤ºè¯å·¥ç¨‹æ•™ç¨‹</p>
                                <div class="workshop-card-tags">
                                    <span class="workshop-tag">å¼€æº</span>
                                    <span class="workshop-tag">æ•™ç¨‹</span>
                                </div>
                            </div>
                            <div class="workshop-card-actions">
                                <a href="https://learnprompting.org/" target="_blank" class="workshop-action-btn">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.35-4.35"></path>
                                    </svg>
                                    æŸ¥çœ‹è¯¦æƒ…
                                </a>
                            </div>
                        </article>

                        <!-- Awesome Prompts -->
                        <article class="workshop-card" data-delay="5">
                            <div class="workshop-card-content">
                                <h3 class="workshop-card-title">Awesome Prompts</h3>
                                <p class="workshop-card-description">150k+ Stars ChatGPT æç¤ºè¯é›†åˆ</p>
                                <div class="workshop-card-tags">
                                    <span class="workshop-tag">å¼€æº</span>
                                    <span class="workshop-tag">GitHub</span>
                                </div>
                            </div>
                            <div class="workshop-card-actions">
                                <a href="https://github.com/f/awesome-chatgpt-prompts" target="_blank"
                                    class="workshop-action-btn">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <circle cx="11" cy="11" r="8"></circle>
                                        <path d="m21 21-4.35-4.35"></path>
                                    </svg>
                                    æŸ¥çœ‹è¯¦æƒ…
                                </a>
                            </div>
                        </article>
                    </div>
                </div>
            </section>

            <!-- Tutorials Section (Dynamic) -->
            <section class="tool-section" id="tutorials" aria-labelledby="tutorials-title">
                <h2 class="section-title" id="tutorials-title">æ•™ç¨‹ / æ¡ˆä¾‹</h2>

                <!-- åˆ†ç±»ç­›é€‰æŒ‰-->
                <div class="category-filters" id="tutorials-filters"
                    style="margin-bottom: 24px; display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;">
                    <!-- åˆ†ç±»æŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿ-->
                </div>

                <div class="tool-grid" id="tutorials-grid">
                    <p class="loading-text">åŠ è½½..</p>
                </div>
            </section>

            <!-- APIs Section (Dynamic) -->
            <section class="tool-section" id="apis" aria-labelledby="apis-title">
                <h2 class="section-title" id="apis-title">API é›†åˆ</h2>

                <!-- ä¸»åˆ†ç±»ç­›-->
                <div class="category-filters" id="apis-category-filters"
                    style="margin-bottom: 16px; display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;">
                    <!-- ä¸»åˆ†ç±»æŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿ-->
                </div>

                <!-- å®šä»·ç­›-->
                <div class="category-filters" id="apis-pricing-filters"
                    style="margin-bottom: 24px; display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;">
                    <!-- å®šä»·æŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿ-->
                </div>

                <div class="tool-grid" id="apis-grid">
                    <p class="loading-text">åŠ è½½..</p>
                </div>
            </section>

            <!-- Trends Section (Dynamic) -->
            <section class="tool-section" id="trends" aria-labelledby="trends-title">
                <h2 class="section-title" id="trends-title">çƒ­ç‚¹è¶‹åŠ¿</h2>
                <div class="tool-grid" id="trends-grid">
                    <p class="loading-text">åŠ è½½..</p>
                </div>
            </section>

            <!-- Solo Section (Static) -->
            <section class="tool-section" id="solo" aria-labelledby="solo-title">
                <h2 class="section-title" id="solo-title">ä¸€äººå…¬å¸</h2>
                <div id="solo-content" class="content-area">
                    <p class="empty-text">åŠ è½½..</p>
                </div>

                <!-- Workflow Cards List - å’Œadmin.htmlä¸€æ ·çš„å¡ç‰‡æ ·å¼ -->
                <div class="workflow-cards-container">
                    <h3 class="workflow-cards-title">å·¥ä½œæµåˆ—(<span id="workflows-count">0</span>)</h3>
                    <div id="workflows-grid" class="workflows-grid">
                        <p class="loading-text">åŠ è½½..</p>
                    </div>
                </div>
            </section>

            <!-- å·¥ä½œæµæŸ¥çœ‹å™¨æ¨¡æ€æ¡† -->
            <div id="workflow-viewer-modal" class="workflow-viewer-modal">
                <div class="workflow-viewer-content">
                    <div class="workflow-viewer-header">
                        <h3 id="workflow-viewer-title" class="workflow-viewer-title"></h3>
                        <button class="workflow-viewer-close" onclick="closeWorkflowViewer()">Ã—</button>
                    </div>
                    <div class="workflow-viewer-canvas-container">
                        <div id="workflow-viewer-canvas" class="workflow-viewer-canvas"></div>
                        <svg id="workflow-viewer-connections"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 3;"></svg>
                    </div>
                </div>
            </div>

            <!-- èŠ‚ç‚¹è¯¦æƒ…æ¨¡æ€æ¡† -->
            <div id="node-detail-modal" class="node-detail-modal">
                <div class="node-detail-content">
                    <button class="node-detail-close" onclick="closeNodeDetail()">Ã—</button>
                    <h3 id="node-detail-title" class="node-detail-title"></h3>
                    <p id="node-detail-desc" class="node-detail-desc"></p>
                    <div id="node-detail-text" class="node-detail-text"></div>
                    <a id="node-detail-link" class="node-detail-link" href="#" target="_blank"
                        style="display: none;">è®¿é—®å·¥å…·</a>
                </div>
            </div>

            <!-- AI Ranking Section -->
            <section class="tool-section" id="ai-ranking" aria-labelledby="ai-ranking-title">
                <h2 class="section-title" id="ai-ranking-title">AIæ’è¡Œæ¦œ</h2>
                <p class="section-description">AIå·¥å…·èƒ½åŠ›åˆ†çº§æ’è¡Œ</p>

                <!-- Ranking Container -->
                <div id="ai-ranking-container" class="ai-ranking-container">
                    <p class="loading-text">åŠ è½½..</p>
                </div>
            </section>

            <!-- Anonymous Thoughts Section (Static) -->
            <section class="tool-section" id="thoughts" aria-labelledby="thoughts-title">
                <h2 class="section-title" id="thoughts-title">åŒ¿åæ€æƒ³å¢™</h2>

                <div class="thoughts-header">
                    <div class="thoughts-filters">
                        <button class="thoughts-filter-btn active" data-category="all">å…¨éƒ¨</button>
                        <button class="thoughts-filter-btn" data-category="emotion">æƒ…ç»ªåˆ†äº«</button>
                        <button class="thoughts-filter-btn" data-category="advice">ç»™ä½œè€…å»ºè®®</button>
                    </div>
                    <button class="btn-write-thought" id="write-thought-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M12 5v14M5 12h14" />
                        </svg>
                        å†™ä¸€æ¡
                    </button>
                </div>

                <div id="thoughts-container" class="thoughts-container">
                    <p class="loading-text">åŠ è½½..</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Write Thought Modal - æ”¾åœ¨bodyçº§åˆ«ç¡®ä¿å±…ä¸­ -->
    <div class="thought-modal" id="thought-modal" style="display: none;">
        <div class="thought-modal-content">
            <button class="thought-modal-close" id="close-thought-modal" aria-label="å…³é—­">Ã—</button>
            <h3>å†™ä¸‹ä½ çš„æƒ³æ³•</h3>
            <form id="thought-form">
                <div class="form-group">
                    <label for="thought-date">æ—¥æœŸ</label>
                    <input type="date" id="thought-date" required>
                </div>
                <div class="form-group">
                    <label for="thought-category">ç±»å‹</label>
                    <select id="thought-category">
                        <option value="emotion">æƒ…ç»ªåˆ†äº«</option>
                        <option value="advice">ç»™ä½œè€…å»ºè®®</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="thought-content">å†…å®¹</label>
                    <textarea id="thought-content" rows="6" placeholder="å†™ä¸‹ä½ çš„æƒ³æ³•..." required></textarea>
                </div>
                <input type="hidden" id="captcha-verified" value="false">
                <button type="submit" class="btn-submit-thought">å‘å¸ƒ</button>
            </form>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰æç¤ºæ¡† -->
    <div class="custom-toast" id="custom-toast" style="display: none;">
        <div class="toast-content">
            <span class="toast-icon" id="toast-icon"></span>
            <span class="toast-message" id="toast-message"></span>
        </div>
    </div>

    <!-- æ‹¼å›¾éªŒè¯å¼¹çª— -->
    <div class="puzzle-captcha-modal" id="puzzle-captcha-modal" style="display: none;">
        <div class="puzzle-captcha-content">
            <div class="puzzle-captcha-header">
                <span>è¯·å®Œæˆå®‰å…¨éªŒè¯</span>
                <button class="puzzle-close-btn" id="puzzle-close-btn" aria-label="å…³é—­">Ã—</button>
            </div>
            <div class="puzzle-captcha-body">
                <div class="puzzle-image-container" id="puzzle-image-container">
                    <canvas id="puzzle-canvas" width="280" height="160"></canvas>
                    <div class="puzzle-piece" id="puzzle-piece"></div>
                    <div class="puzzle-slot" id="puzzle-slot"></div>
                </div>
                <div class="puzzle-hint" id="puzzle-hint">æ‹–åŠ¨ä¸‹æ–¹æ»‘å—å®Œæˆæ‹¼å›¾</div>
                <div class="puzzle-slider-container">
                    <div class="puzzle-slider-track" id="puzzle-slider-track">
                        <div class="puzzle-slider-progress" id="puzzle-slider-progress"></div>
                        <div class="puzzle-slider-thumb" id="puzzle-slider-thumb">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="9 18 15 12 9 6" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="puzzle-captcha-footer">
                <button class="puzzle-refresh-btn" id="puzzle-refresh-btn">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M23 4v6h-6M1 20v-6h6" />
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
                    </svg>
                    æ¢ä¸€å¼ 
                </button>
            </div>
        </div>
    </div>

    <!-- Background Mode Switcher (Optional - Press 'B' to toggle) -->
    <div class="bg-mode-switcher" id="bg-mode-switcher" style="display: none;">
        <button class="bg-mode-btn active" data-mode="energy" onclick="switchBgMode('energy')">èƒ½é‡/button>
            <button class="bg-mode-btn" data-mode="snow" onclick="switchBgMode('snow')">ä¸‹é›ª</button>
            <button class="bg-mode-btn" data-mode="stars" onclick="switchBgMode('stars')">æ˜Ÿç©º</button>
    </div>

    <script>
        // Background mode switcher
        function switchBgMode(mode) {
            if (window.setBackgroundMode) {
                window.setBackgroun
            }
            // Update active button
            document.querySelectorAll('.bg-mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });
        }

        // Toggle switcher visibility (press 'B' key)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'b' || e.key === 'B') {
                const switcher = document.getElementById('bg-mode-switcher');
                if (switcher) {
                    switcher.style.display = switcher.style.display === 'none' ? 'flex' : 'none';
                }
            }
        });
    </script>

    <!-- Footer -->
    <footer class="site-footer tools-page-footer" role="contentinfo">
        <div class="footer-content" style="display:flex;justify-content:flex-end;padding:16px 24px;">
            <p class="footer-text" id="tools-footer-text" style="margin:0;font-size:12px;color:#64748b;">Â© 2024 Aethrix
                | ä»¥å¤ª ä»¥å¤ªå¤œæ¼«æ¼«ï¼Œç²’å­ç”Ÿç”Ÿä¸æ¯</p>
        </div>
    </footer>

    <script src="main.js?v=2026011402"></script>

    <!-- Theme Toggle Script for Tools Page -->


    <!-- User Profile Script -->
    <script>
        let userProfile = null;

        // Check user login status and update UI
        async function checkUserStatusAndUpdateUI() {
            try {
                const authLink = document.getElementById('auth-link')   onst userAvatar = document.getEle('user-avatar');
                const avatarText = document.getElementById('avatar-text');

                // é¦–å…ˆæ£€æŸ¥ window.currentUserï¼ˆç”±é¡µé¢é¡¶éƒ¨ checkAuth è®¾ç½®ï¼‰
                if (window.currentUser && window.currentUser.email) {
                    console.log('ä½¿ç”¨ window.currentUser:', window.currentUser);
                    // User is logged , hide auth icon
                    if (authLink) authLink.style.display = 'none';
                    if (userAvatar) {
                        userAvatar.style.display = 'flex';
                        const displayText = window.currentUser.displayName
                            ? window.currentUser.displayName.charAt(0).toUpperCase()
                            : (window.currentUser.nickname
                                ? window.currentUser.nickname.charAt(0).toUpperCase()
                                : widow.currentUser.email.charAt(0).toUpperCase());
                        avatarText.textContent = displayText;
                    }
                    // Set userProfile from window.currentUser
                    userProfile = {
                        uid: window.currentUser.uid,
                        email: window.currentUser.email,
                        nickname: window.currentUser.nickname || window.currentUser.displayName || window.currentUser.email.split('@')[0],
                        displayName: window.currentUser.displayName,
                        photoURL: window.currentUser.photoURL,
                        isAdmin: window.currentUser.isAdmin || false
                    };
                    updateProfilePopup();
                    return;
                }

                // å¦‚æœ window.currentUser ä¸å­˜åœ¨ï¼Œå°è¯•ä» Firebase è·å–
                window.FirebaseConfig.initializeFirebase();
                const user = await window.AuthStateManager.waitForAuthReady(2000);

                if (user) {
                    // User is loggtar, hide auth icon
                    if (authLink) authLink.style.display = 'none';
                    if (userAvatar) {
                        userAvatar.style.display = 'flex';
                        Text = user.displayName
                            ? user.displayName.charAt(0).toUpperCase()
                            : user.email.charAt(0).toUpperCase();
                        avatarText.textContent = displayText;
                    }
                    // Load full profile
                    loadUserProfile(usr);
                } else {
                    // User not logged in - show auth icon
                    if (authLink) authLink.style.display = 'flex';
                    if (userAvatar) userAvatar.style.display = 'none';
                }
            } catch (error) {
                console.error('Failed to check user status:', error);
            }
        }

        // Load user profile data from Firebase user
        async function loadUserProfile(user) {
            try {
                userProfile = {
                    uid: user.uid,
                    email: user.email,
                    nickname: user.displayName || user.email.split('@')[0],
                    displayName: user.displayName,
                    photoURL: user.photoURL,
                    emailVerified: user.emailVerified,
                    isAdmin: window.RoleManager ? window.RoleManager.checkAdminStatus(user.email) : false
                };
                updateProfilePopup();
            } catch (error) {
                console.error('Failed to load user profile:', error);
            }
        }

        // Update profile popup with user data
        function updateProfilePopup() {
            if (!userProfile) return;

            const nicknameEl = document.getElementById('profile-nickname');
            const emailEl = document.getElementById('profile-email');

            if (nicknameEl) nicknameontent = userProfile.nickname || '-';
            if (emailEl) emailEl.textContent = userProfile.email || '-';

            //æŒ‰é’® - ä½¿ç”¨åç«¯APIç¡®è®¤ç®¡ç†å‘˜çŠ¶æ€
            const adminBtn = document.getElementById('tools-admin-btn');
            if (adminBtn) {
                // å…ˆæ ¹æ®æœ¬åœ°çŠ¶æ€       if (userProfile.isAdmin) {
                adminBtn.style.display = 'flex';
                console.log('ç®¡ç†å‘˜æŒ‰é’®å·²æ˜¾ç¤ºï¼ˆtoolsé¡µé¢ - æœ¬åœ°çŠ¶æ€ï¼‰');
                // å†ä»åç«¯APIç¡®è®¤ç®¡ç†å‘˜çŠ¶æ€ï¼ˆç¡®ä¿å‡†ç¡®æ€§ï¼‰
                fetch('/api/user/status', { credentials: 'include' })
                    .then(res => res.json())
                    .then(data => {
                        if (data.isUser && data.isAdmin) {
                            adminBtn.style.display = 'flex';
                            console.log(' - åç«¯ç¡®è®¤ï¼‰');
                            // æ›´æ–°æœ¬åœ°çŠ¶æ€
                            userProfile.isAdmin = true;
                            if (window.currentUser) {
                                window.currentUser.isAdmin = true;
                            }
                        } else {
                            adminBtn.style.display = 'none';
                        }
                    })
                    .catch(err => {
                        console.log('æ£€æŸ¥ç®¡ç†å‘˜çŠ¶æ€å¤±è´¥:', err);
                        // å‡ºé”™æ—¶ä¿æŒæœ¬åœ°çŠ¶æ€
                        if (!userProfile.isAdmin) {
                            adminBtn.style.display = 'none';
                        }
                    });
            }
        }

        // Show profile message (success or error)
        function showProfileMessage(message, type = 'success') {
            const msgEl = document.getElementById('profile-message');
            if (!msgEl) return;

            msgEl.textContent = message;
            msgEl.style.display = 'block';

            if (type === 'success') {
                msgEl.styleund = '#e8f5e9';
                msgEl.style.color = '#2e7d32';
                msgEl.style.border = '1px solid #a5d6a7';
            } else {
                msgEl.style.background = '#ffebee';
                msgEl.st'#c62828';
                msgEl.style.border = '1px solid #ef9a9a';
            }

 / Auto hide after 3 seconds
            setTimeout(() => {
                msgEl.style.display = 'none';
            }, 3000);
        }

        // Toggle profile popup
        function toggleProfilePopup() {
            const popup = document.getElementById('profile-popup');
            if (popup.style.display === 'none') {
                popup.style.display = 'block';
            } popup.style.display = 'none';
        }
        }

        // Close profile popup
        function closeProfilePopup() {
            doetElementById('profile-popup').style.display = 'none';
        }

        // Enter edit mode
        function enterEditMode() {
            document.getElementById('profile-view-mode').style.display = 'none';
            document.getElementById('profile-edit-mode').style.display = 'block';
            document.getElementById('piew-buttons').style.display = 'none';
            document.getElementById('profile-edit-buttons').style.display = 'block';

            // Pre-fill current va         document.getElementById('edit-nickname').value = userProfile?.nickname || '';
            document.getElementById('edit-email').textContent = userProfile?.email || '-';
            document.getElementById('edit-error').textContent = '';
        }

        // Cancel edit mode
        function cancelEditMode() {
            document.getElementById('profile-view-mode').style.display = '        document.getElementById('profile - edit - mode').style.display = 'none';
            document.getElementById('profile-view-buttons').style.display = 'block';
            document.getElementById('profile-edit-buttons').style.display = 'none';
            document.getElementById('edit-error').tex = '';
        }

        // Save profile changes
        async function saveProfileChanges() {
            const nickname = document.getElementById('edit-nickname').value.trim();
            const errorEl = document.getElementById('edit-error');

            // Validation
            if (!nickname || nickname.length < 2 || nickname.length > 20) {
                errorEl.textContent = 'æ˜µç§°é•¿åº¦éœ€è¦åœ¨2-20ä¸ªå­—ç¬¦ä¹‹é—´';
                return;
            }

            try {
          nst auth = window.FirebaseConfig?.getAuth();

                // é¦–å…ˆåŒæ­¥ Firebase ç”¨æˆ·åˆ°åç«¯ï¼ˆç¡®ä¿user_token cookieå­˜åœ¨ï¼‰
                if (auth?.currentUser) {
                    console.log('æ­£åœ¨åŒæ­¥ Firebase ç”¨æˆ·åˆ°åç«¯...');
                    tr                const idToken = await auth.currentUser.getIdToken();
                    const syncResponse = await fetch('/api/auth/firebase-sync', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'applic                             'Authorization': `Bearer ${idToken}`
                            },
                        credentials: 'include',
                        body: JSON.stringify({
                            uid: auth.currentUser.uid,
                            email: auth.currentUser.email,
                            displayName: auth.currentUser.displayName,
                            photoURL: auth.currentUser.photoURL,
                            provider: auth.currentUser.providerData[0]?.providerId || 'password'
                        })
                    });

                    const syncResult = await syncResponse.json();
                    console.log('Firebase sync result:', syncResult);

                    if (!syncResponse.ok) {
                        console.error('Firebase sync failed:', syncResult);
                        errorEl.textContent = 'åŒæ­¥ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•åå†è¯•';
                        return;
                    }
                } catch (syncErr) {
                    console.error('åŒæ­¥åˆ°åç«¯å¤±è´¥:', syncErr); errorEl.textContent = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•';
                    return;
                }
            }

                // ç­‰å¾…ä¸€å°æ®µæ—¶é—´ç¡®ä¿ cookieit new Promise(resolve => setTimeout(resolve, 100));

                console.log('æ­£åœ¨æ›´æ–°ç”¨æˆ·èµ„æ–™...');
            const response = await fetch('/api/user/update-profile', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include',
                body: JSON.stringify({ nickname })
            });

            const result = await response.json();
            console.log('Update profilsult);

                if (result.success) {
                // Update local profile
                usee = nickname;
                if (window.currentUser) {
                    window.currentUser.nickname = nickname;
                }
                updateProfilePopup();

                // Update Firebase displayName if available
                if (auth?.currentUser) {
                    try {
                t auth.currentUser.updateProfile({ displayName: nickname });
                        console.log('Firebase displayNa                  } catch (e) {
                            console.log('æ›´æ–° Firebase displayName å¤±è´¥:', e);
                    }
                    }

                // Update avatar text
                const avatarText = document.getElementById('avatar-text');
                if (avatarTex         avatarText.textContent = nickname.charAt(0).toUpperCase();
            }

            cancelEditMode();

            // Show inline success message
            showProfileMessage('ä¿¡æ¯æ›´æ–°æˆåŠŸ', 'success');
        } else {
            errorEl.textContent = result.message || 'æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
        }
            } catch (error) {
            console.error('Update profile error:', error);
            tent = 'æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
        }
        }

        // Handle logout
        async function handleLogout() {
            try {
                // å…ˆæ¸…é™¤æœ¬åœ°å­˜å‚¨çŠ¶æ€ï¼ˆé˜²æ­¢é¡µé¢é—ªçƒï¼‰
                // åŒæ—¶æ¸…é™¤ Firebase å’Œ GitHub OAuth çš„è®¤è¯çŠ¶æ€
                if (window.AuthStateManager & nager.clearAuthState) {
                    eManager.clearAuthState();
                } else {
                    localStorage.removeItem('firebase_auth_state');
                }
                localStorage.removeItem('github_auth_state');

                // Use Firebase EmailAuth module to logout (å¦‚æœFirebase ç™»å½•)
                if (window.EmailAuth) {
                    try {
                        await window.EmailAuth.logout();
                    } catch (e) {
                        console.log('Firebase logout error:', e);
                    }
                } else {
                    // Fallback: sign out directly
                    const auth = window.FirebaseConfig && window.FirebaseConfig.getAuth();
                    if (auth && auth.currentUser) {
                        await auth.signOut();
                    }
                }

                // Clear any remaining cookies
                document.cookie Path =/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
                document.cookie = 'admin_token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';

                // Redirect to home
                window.location.href = '/';
            } catch (error) {
                console.error('Logout error:', error);
                // ç¡®ä¿æ¸…é™¤æœ¬åœ°çŠ¶æ€
                localStorage.removeItem('firebase_auth_state');
                localStorage.removeItem('github_auth_state');
                // Force redirect even on error
                window.location.href = '/';
            }
        }

        // Close popup when clicking outsient.addEventListener('click', function (e) {
        const popup = document.getElementById('profile-popup');
        const avatar = document.getElementById('user-avatar');
        if (popup && popup.style.display === 'block' &&
            pup.contains(e.target) && !avatar.contains(e.target)) {
            popup.style.display = 'none';
        }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', checkUserStatusAndUpdateUI);

        // Load tools footer from settings
        async function loadToolsFooter() {
            try {
                const response = await fetch('/api/settings');
                if (rok) {
                    const data = await response.json();
                    if (data.footer && data.footer.toolsFooter) {
                        const footerEl = document.getElementById('tools-footer-text');
                        if (footerEl) {
                            footerEl.textCntent = data.footer.toolsFooter;
                        }
                    }
                }
            } catch (e) {
                consoleFailed to load tools footer: ', e);
            }
        }
        document.addEventListener('DOMContentLoaded', loadTor);

        // ========== AI Rankings Section ==========

        let aiRankingsData = { boards: [] };
        let collapsedTiers = new Set();
        let collapsedBoards = new Set();
        let currentBoardId = null;

        // Load AI Rankings
        async function loadAiRankings() {
            const container = document.getElementById('ai-ranking-container');
            if (!container) {
                console.error('[AI Rankings] å®¹å™¨æœªæ‰¾åˆ°');
                return;
            }

            console.log('[AI Rankings] å¼€å§‹åŠ è½½æ•°æ®...');

            try {
                const res = await fetch('/api/ai-rankings');
                if (res.ok) {
                    aiRankingsData = await res.json();
                    console.log('[AI Rankings] æ•°æ®åŠ è½½æˆåŠŸ:', aiRankingsData)              renderAiRankings();
                } el                 console.error('[AI Rankings] åŠ è½½å¤±è´¥ï¼ŒçŠ¶æ€ç :', res.status);
                container.innerHTML = '<p class="empty-text">åŠ è½½å¤±è´¥</p>';
            } catch (e) {
                console.error('[AI Rankings] åŠ è½½å¼‚å¸¸:', e);
                container.innerHTML = '<p class="empty-text">åŠ è½½å¤±è´¥</p>';
            }
        }

        // Render AI Rankings - å¤šæ¦œç»“æ„
        function renderAiRankings() {
            const contment.getElementById('ai-ranking-container');
            tainer || !aiRankingsData.boards) {
                console.error('[AI Rankings] æ¸²æŸ“å¤±è´¥ - å®¹å™¨æˆ–æ•°æ®ä¸å­˜åœ¨');
                return;
            }

            console.log('[AI Rankings] å¼€å§‹æ¸²æŸ“ï¼Œæ¦œå•æ•°é‡:', aiRankingsData.boards.length);

            if (aiRankingsData.boards.length === 0) {
                container.innerHTML = '<p class="empty-text">æš‚æ— æ’è¡Œæ•°æ®</p>';
                return;
            }

            // æ¸²æŸ“æ¦œå•é€‰æ‹©å™¨å’Œå½“å‰æ¦œå•
            container.innerHTML = `
                <div class="boards-tabs">
                    ${aiRankingsData.boards.map(board => `
                        <button class="board-tab ${currentBoardId === board.id || (!currentBoardard.order === 0) ? 'active' : ''}" 
                                onclick="selectBoard('${board.id}')">${escapeHtmlTools(board.name)}</button>
                    `).join('')}
                </div>
                <div class="board-content">
                    ${renderCurrentBoard()}
                </div>
 ;

            console.log('[AI Rankings] æ¸²æŸ“å®Œæˆ');
        }

        // Render curre     function renderCurrentBoard() {
            const board = currentBoardId
                ? aiRankingsData.boards.find(b => b.id === currentBoardId)
              gsData.boards[0];

            if (!board) return '<p class="empty-text">è¯·é€‰æ‹©æ¦œå•</p>';

            currentBoardId = board.id;

            return board.tiers.map(tier => {
                return `
                < div class="tier-row" data - tier - id="${tier.id}" data - board - id="${board.id}" >
                        <div class="tier-label" style="background:${tier.color};color:${tier.textColor};">
                            <span class="tier-name">${escapeHtmlTools(tier.name)}</span>
                        </div>
                        <div class="tier-items">
                             && tier.items.length > 0 ? tier.items.map(item => {
            // Auto-fetch logo from link if no image provided
                    let logoUrl = item.image;
                   if (!logoUrl && item.link) {
                        try {
                            const url = new URL(item                        logoUrl = `https://icon.horse/icon/${url.ho                      } catch (e) {
                logoUrl = null;
                        }
                    }

                    return `
                                <div class="tier-item" onclick="openRankingModal('${board.id}', '${tier.id}', '${item.id}')">
                                    ${logoUrl ? `<img loading="lazy" src="${escapeHtmlTools(logoUrl)}" alt="${escapeHtmlTools(item.name)}" class="tier-item-img" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">` : ''}
                                    <div class="tier-i                    lay:${logoUrl ? 'none' : 'flex'};align-items:cente                    ze:20px;font-weight:700;co                    adient(135deg, #1e293b 0%, #3                        .name)                                                        <spa                            ls(item.name)}</span>
                                                           `;
                                              </div                                              );a                    boardId) {
            currentBoardId = boardId;
            renderAiRankings();
        }

        // Toggle tier collapse
        function toggleTierCollapse(boardId, tierId) {
            const key = `${boardId}-${tierId}`;
            if (collapsedTiers.has(key)) {
                collapsedTiers.delete(key);
            } else {
                collapsedTiers.add(key);
            }
            renderAiRankings();
        }

        // Open ranking item modal
        function openRankingModal(boardId, tierId, itemId) {
            const board = aiRankingsData.boards.find(b => b.id === boardId);
            if (!board) return;
            const tier = board.tiers.find(t => t.id === tierId);
            if (!tier) return;
            const item = tier.items.find(i => i.id === itemId);
            if (!item) return;

            // Create modal if not exists
            let mod                ('ranking-detail-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.iking-detail-modal';
                modal.className = 'ranking-modal';
                modal.innerHTML = `
                    <div class="rankincontent">
                        <button class="ranking-modal-close" onclick="closeRankingModal()">Ã—</button>
                        <div class="ranking-modal-body"></div>
                    </div>
                `;
                document.body.appendChild(modal);

                // Close on backdrop click
                modal.addEvner('click', function (e) {
                    if (e.target === modal) closeRankingModal();
                });
            }

            // Populate modal
            const body = modal.querySelector('.ranking-modal-body');
            body.innerHTML = `
                <div class="ranking-detail">
                    ${item.image ? `<img src="${escapeHtmlTools(item.image)}" alt="${escapeHtmname)}" class="ranking-detail-img">` : ''}
                    <h3 class="ranking-detail-name">${escapeHtmlTools(item.name)}</h3>
                    <p class="ranking-detail-tier" style="color:${tier.color};">å±‚çº§: ${escapeHtmlTools(tier.name)}</p>
                    ${item.description ? `<p class="ranking-detail-desc">${escapeHtmlTools(item.description)}</p>` : ''}
                    ${item.link ? `<a href="${escapeHtmlTools(item.link)}" target="_blank" rel="noopener noreferrer" class="ranking-detail-link">è®¿é—®é“¾æ¥ /a>` : ''}
                </div>
            `;

            modal.style.display = 'flex';
        }

        // Close ranking modaon closeRankingModal() {
            const modal = document.getElementById('ranking-detail-modal');
                        if (modal) modal.style.display = 'none';
        }

                        // Escape HTML helper
                        funHtmlTools(text) {
            if (!text) return '';
                        const div = document.createElement('div');
                        div.textContent = text;
                        return div.innerHTML;
        }

                        // Load AI rankings when page loads (auto-load)
                        document.addEventListener('DOMContentLoaded', function () {
                            // Auto-load AI rankings on page load - é¡µé¢åŠ è½½æ—¶å°±æ˜¾ç¤º
                            console.log('[AI Rankings] å¼€å§‹è‡ªåŠ¨åŠ è½½æ’è¡Œæ¦œæ•°æ®...');
                        loadAiRankings();
        });

                        // ========== Anonymous Thoughts Modal ==========

                        // Open thought modal
                        function openThoughtModal() {
            const modal = document.getElementById('thought-modal');
                        if (modal) {
                            modal.style.display = 'flex';
                        // Set default date to today
                        const dateInput = document.getElementById('thought             if (dateInput) {
                            datalue = new Date().toISOString().split('T')[0];
                }
                        // Reset puzzle captcha
                        resetPuzzleCaptcha();
            }
        }

                        // Close thought modal
                        fuloseThoughtModal() {
            const modal = document.getElementById('thought-modal');
                        if (modal) {
                            modal.style.display = 'none';
                        // Reset form
                        const form = document.getElementByIht-form');
                        if (form) form.reset();
                        // Reset slider captcha
                        resetPuzzleC aptcha();
            }
        }

                        // ========== Puzzle Slider Captcha Logic ==========
                        let sliderVerified = false;
                        let puzzleTargetX = 0;
                        t failCount = 0;
                        let isLocked = false;
                        let r = null;
                        let lockEndTime = 0;
                        const PUZZLE_TOLERANCE = 8; // å…è®¸çš„è¯¯å·®èŒƒå›´ï¼ˆåƒç´ ï¼‰
                        const MAX_FAIL_COUNT = 3; // æœ€å¤§å¤±è´¥æ¬¡æ•°
                        const LOCK_DURATION = 60; // é”å®šæ—¶é—´ï¼ˆç§’ï¼‰
                        const CAPTCHA_STORAGE_KEY = 'puzzle_captcha_state';

                        // ä» localStorage åŠ è½½çŠ¶æ€
                        function loadCaptchaState() {
            try {
                const stored = localStorage.getItem(CAPTCHA_STORAGE_KEY);
                        if (stored) {
                    const state = JSON.parse(stored);
                        failCount = state.failCount || 0;
                        ime = state.lockEndTime || 0;

                    // æ£€æŸ¥æ˜¯å¦ä»åœ¨é”å®šæœŸ
                    if (lockEndTime > Date.now()) {
                            isLocked = true;
                    } else {
                            // é”å®šå·²è¿‡æœŸï¼Œé‡ç½®
                            isLocked = false;
                        if (lockEndTime > 0) {
                            failCount = 0;
                        saveCaptchaState();
                        }
                    }
        }
            } catch (e) {
                            console.log('Failed to load captcha state:', e);
            }
        }

                        // ä¿å­˜çŠ¶æ€åˆ° localStorage
                        function saveCaptchaState() {
            try {
                            localStorage.setItem(CAPTCHA_STORAGE_KEY, JSON.stringify({
                                failCount: failCount,
                                lockEndTime: lockEndTime
                            }));
            } catch (e) {
                            console.lod to save captcha state:', e);
            }
        }

                        // é¡µé¢åŠ è½½æ—¶æ¢å¤çŠ¶æ€
                        loadCaptchaState();

                        // éªŒè¯ç”¨çš„æœ¬åœ°å›¾ç‰‡åˆ—è¡¨
                        const puzzleImages = [
                        '/captcha-images/bg1.svg',
                        '/captcha-images/bg2.svg',
                        '/captcha-images/bg3.svg',
                        '/captcha-images/bg4.svg',
                        '/captcha-images/bg5.svg',
                        ages/bg6.svg',
                        '/captcha-images/bg7.svg',
                        '/captcha-images/bg8.svg'
                        ];

                        function openPuzzleCaptcha() {
            const modal = document.getElementById('puzzle-captcha-modal');
                        if (modal) {
                            // é‡æ–°åŠ è½½çŠ¶æ€ï¼ˆé˜²æ­¢å¤šæ ‡ç­¾é¡µé—®é¢˜ï¼‰
                            loadCaptchaState();

                        // æ£€æŸ¥æ˜¯å¦è¢«é”å®š
                        if (isLocked) {
                    const remaining = Math.ceil((lockEndTime - Date.now()) / 1000);
                    if (remaining > 0) {
                            showToast(`éªŒè¯å¤±è´¥æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç­‰å¾… ${remç§’åé‡è¯•`, 'error');
                        return;
                    } else {
                        // é”å®šæ—¶é—´å·²è¿‡
                        isLocked = false;
                        failCount = 0;
                        saveCaptchaState();
                    }
                }
                modal.style.display = 'flex';
                initPuzzleCaptcha();
            }
        }

function closePuzzleCaptcha() {
            const document.getElementById('puzzle-captcha-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function initPuzzleCaptcha() {
            const canvas = document.getElementById('puzzle-canvas');
            const ctx = canvas.getContext('2d');
            const piece = document.getElementById('puzzle-piece');
       st slot = document.getElementById('puzzle-slot');
            const thumb = document.getElementById('puzzle-slider-thumb');
            const progress = document.getElementById('puzzle-slider-progress');
        = document.getElementById('puzzle-slider-track');
            const hint = document.getElementById('puzzle-hint');

            if (!canvas || !ctx || !piece || !slot || !thumb || !track) return;

            // æ‹¼å›¾å—å¤§å°
            const pieceSize = 44;
            const pieceRadius = 8;

            // éšæœºç”Ÿæˆæ‹¼å›¾ä½ç½®ï¼ˆç¡®ä¿åœ¨åˆç†èŒƒå›´å†…ï¼‰
            puzzleTargetX = Math.floor(Math.random() * (canvas.width - pieceSize - 80)) + 60;
            const puzzleY = Math.floor(Math.random() * (canvas.height - pieceSize - 20)) + 10;

            // åŠ è½½éšæœºå›¾ç‰‡
            const img = new Image();
            img.crossOrigin = 'Anonymous';
            img. function () {
                // ç»˜åˆ¶èƒŒæ™¯å›¾
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

                // ç»˜åˆ¶æ‹¼å›¾ç¼ºå£ï¼ˆåŠé€æ˜é®ç½©ï¼‰
                drawPuzzleSlot(ctx, puzzleTargetX, puzzleY, pieceSceRadius);

                // è®¾ç½®æ‹¼å›¾å—ä½ç½®å’Œæ ·å¼
                piece.style.width = pieceSize + 'px';
                piece.style.height = pieceSize + 'px';
                piece.style.top = puzzleY + 'px';
                piece.style.left = '0px';
                piece.style.display = 'block';

                // åˆ›å»ºæ‹¼å›¾å—å›¾åƒ
                createPuzzlePiece(img, puzzleTargetX, puzzleY, pieceSize, pieceRadius, piece);

                // è®¾ç½®ç¼ºå£ä½ç½®æŒ‡ç¤º
                slot.style.width = pieceSize + 'px';
                slot.style.height = pieceSize + 'px';
                slot.style.top = p';
                slot.style.left = puzzleTargetX + 'px';
                slot.s = 'block';
            };
            img.onerror = function () {
                // å¦‚æœå›¾ç‰‡åŠ                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, '#667eea');
                gradient.addColorStop(1, '#764ba2');
                ctx.fillSent;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // æ·»åŠ ä¸€äº›è£…é¥°
                ctx.fillStyle = 'rgba(2 55,255,255,0.1)';
                for (let i = 0; i < 5; i++) {
                    ctx.beginPath();
    ctx.arc(Math.random() * canvas.width, Math.random() * canvas.height, Math.random() * 30 + 10, 0, Math.PI * 2);
    ctx.fill();
                }

                drawPuzzleSlot(ctx, puzzleTargetX, puzzleY, pieceSize, pieceRadius);

                piece.style.width = pieceSize + 'px';
                piece.style.height = pieceSize + 'px';
                piece.style.top = puzzleY + 'px';
   ce.style.left = '0px';
                piece.style.display = 'block';
                piece.style.background = 'linear-grad7eea 0%, #764ba2 100%)';
                piece.style.borderRadius = '4px';
                piece.style.boxShadow = '2px 2px 8px rgba(0,0,0,0.3)';

                slot.style.width = pieceSize + 'px';
                slot.style.height = pieceSize + 'px';
                slot.style.top = puzzleY + 'px';
                slot.style.left =  puzzleTargetX + 'px';
                slot.style.display = 'block';
            };

            // éšæœºé€‰æ‹©å›¾ç‰‡
            const randomIndex = Math.floor(Math.random() * puzzleImages.length);
            img.src = puzzleImages[randomIndex];

            // åˆå§‹åŒ–æ»‘å—
            initPuzzleSlider(piece, thumb, progress, track, hint, pieceSize);
        }
n drawPuzzleSlot(ctx, x, y, size, radius) {
            ctx.save();
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0,0,0,1)';

            // ç»˜åˆ¶æ‹¼å›¾å½¢çŠ¶
            ctx.beginPath();
            ctx.moveTo(x, y + radius);
            ctx.arcTo(x, y, x + radius, y, radius);
            ctx.lineTo(x + siz            ctx.arcTo(x + size, y, x + size, y + radius, radius);
            ctx.line size - radius);
            ctx.arcTo(x + size, y + size, x + size - radius, y + size, radius);
            ctx.lineTo(x + radius, y + size);
            ctx.arcTo(x, y + size, x, y + size - radius, radius);
            ctx.closePath();
            ctx.fill();
            ctx.restore();

            // ç»˜åˆ¶ç¼ºå£è¾¹æ¡†
            ctx.save();
            ctx.strokeStyle = 'rgba(255,255,255,0.8)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            c radius);
            ctx.arcTo(x, y, x + radius, y, radius);
            ctx.lineTo(x + size - radius, y);
            ctx.arcTo(x + size, y, x + size, y + radius, radius);
            ctx.lineTo(x + size, y + size - radius);
            ctx.arcTo(x + size, y + size, x + s, y + size, radius);
            ctx.lineTo(x + radius, y + size);
            ctx.arcTo(x, y + size, x, y + size - radius, radius);
            ctx.clos         ctx.stroke();
            ctx.restore();

            // æ·»åŠ å†…éƒ¨é˜´å½±æ•ˆæœ
            ctx.save();
           lStyle = 'rgba(0,0,0,0.3)';
            ctx.beginPath();
            ctx.moveTo(x + 2, y + radius + 2);
            ctx.arcTo(x + 2, y + 2, x + radius + 2, y + 2, radius);
            ctx.lin - radius - 2, y + 2);
            ctx.arcTo(x + size - 2, y + 2, x + size - 2, y + radius + 2, radius);
            ctx.lineTo(x + size - 2, y + size - radius - 2);
            ctx.arcTo(x + size - 2, y + size - 2, x + size - radius - 2, y + size - 2, radius);
            ctx.lineTo(x + radius + 2, y + size - 2);
            ctx.arcTo(x + 2, y + size - 2, x + 2, y + size - radius - 2, radius);
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }

        function createPuzzlePiece(img, x, y, size, radius, pieceElement) {
            conas = document.createElement('canvas');
            pieceCanvas.width = size;
            pieceCanvas.height = size;
            const pieceCtx = pieceCanvas.getContext('2d');

            // åˆ›å»ºåœ†è§’çŸ©å½¢è·¯å¾„
            pieceCtx.beginPath();
            pieceCtx.moveTo(0, radius);
            pieceCtx.arcTo(0, 0, radius, 0, radius);
            pieceCtx.lineTo(size - radius, 0);
            pieceCtx.arcTo(size, 0, size, radius, radius);
            pieceCtx.lineTo(size, size - radius);
            pieceCtx.arcTo(size, size, size - radius, size, radius);
            pieceCtx.lineTo(radius, size);
            pieceCtx.arcTo(0, size, 0, size - radius, radius);
            pieceCtx.closePath();
pieceCtx.clip();

            // ç»˜åˆ¶å¯¹åº”ä½ç½®çš„å›¾ç‰‡
            pieceCtx.drawImage(img, x, y, size, size, 0, 0, size, size);

            // æ·»åŠ è¾¹æ¡†
            pieceCtx.strokeStyle = 'rgba(255,255,255,0.9)';
            pieceCtx.lineWidth = 2;
            pieceCtx.stroke();

            // è®¾ç½®æ‹¼å›¾å—èƒŒæ™¯
            pieceElement.style.backgroundImage = 'url(' + pieceCanvas.toDataURL() + ')';
            pieceElement.style.backgroundSize = 'cover';
            pieceElement.style.boxShadow = '3px 3px 10px rgba(0,0,0,0.4)';
            pieceElement.style.borderRadius = radius + 'px';
        }

        function initPuzzleSlider(piece, thumb, progress, track, hint, pieceSize) {
            let isDragging = false;
            let startX = 0;
            let currentX = 0;
    const maxX = track.offsetWidth - thumb.offsetWidth - 4;
            const pieceMaxX = 280 - pieceSize; // canvaså®½åº¦ - æ‹¼å›¾å—å®½åº¦

            // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨
            const newThumb = thumb.cloneNode(true);
            thumb.parentNode.replaceChild(newThumb, thumb);
            thmb;

            function onStart(e) {
                if (sliderVerified) return;
                isDragging = true;
                startX = (e.touches ? e.touches[0].clientX : e.clientX);
                thumb.style.cursor = 'grabbing';
                hint.textContent = 'æ‹–åŠ¨æ»‘å—å®Œæˆæ‹¼å›¾';
                hint.style.color = '';
            }

            function onMove(e) {
                if (!isDragging || sliderVerified) return;
                e.preventDefault();

                const clientX = e.touches ? e.touches[0].clientX : e.clientX      let deltaX = clientX - startX;
                let newX = Math.max(0, Math.min(deltaX, maxX))      currentX = newX;

                thumb.style.left = (newX + 2) + 'px';
                progress.style.width = (newX + thumb.offsetWidth / 2)              // åŒæ­¥ç§»åŠ¨æ‹¼å›¾å—
                const pieceX = (newX / maxX) * pieceMaxX;
                piece.style.left = pieceX + 'px';
            }

            function onEnd() {
                if (!isDragging || sliderVerified) return;
                isDragging = false;
                thumb.style.cursor = 'grab'           // è®¡ç®—æ‹¼å›¾å—ä½ç½®
                const pieceX = (currentX / maxX) * pieceMaxX;

                // æ£€æŸ¥æ˜¯å¦åŒ¹é…
                if (Math.abs(pieceX - puzzleTargetX) <= PUZZLE_TOLERANCE) {
                    // éªŒè¯æˆåŠŸ
                    verifyPuzzleSuccess();
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œé‡ç½®
        verifyPuzzleFail();
                }
            }

            // Mouse events
            thumb.addEventListener('mousedown', onStart);
            document.ener('mousemove', onMove);
            document.addEventListener('mouseup', onEnd);

            // Touch events
            thumb.addEventListener('touchstart', onStart, { passive: false });
            document.addEventListener('touchmove', onMove, { passive: false });
            document.addEventListener('touchend', onEnd);
       function verifyPuzzleSuccess() {
            sliderVerified = true;
            const hint = document.getElementById('puzzle-hin const captchaInput = document.getElementById('captcha-verified');

            if (hint) {
                hint.textContent = 'éªŒè¯æˆåŠŸï¼';
                hint.style.color = '#10b981';
            }

            if (captchaInp      captchaInput.value = 'true';
            }

            // å»¶è¿Ÿå…³é—­å¼¹çª—å¹¶æäº¤
            setTimeout(() => {
                closePuzzle           // é‡ç½®å¤±è´¥è®¡æ•°å¹¶ä¿å­˜
                failCount = 0;
                lockEndTime = 0;
                isLocked = false;
                saveCaptchaS            // å¦‚æœæœ‰å¾…æäº¤çš„æ•°æ®ï¼Œè‡ªåŠ¨æäº¤
                if (pendingThoughtData) {
                    doSubmitThought(pendingThoughtData.date, pendingThoughtData.category, pendingTho);
                    pendingThoughtData = null;
                }
            }, 600);
   function verifyPuzzleFail() {
            failCount++;
            saveCaptchaState(); // ä¿å­˜å¤±è´¥æ¬¡æ•°

            const hint = document.getElementById('puzzle-hint');
            const piece = document.getElementById('puzzle-piece');
            const thumb = document.getElementById('puzzle-slider-thumb    const progress = document.getElementById('puzzle-slider-progress');
            const sliderContainer = document.querySelector('.puzzle-slider-container');

            // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°æœ€å¤§å¤±è´¥æ¬¡æ•°
            if = MAX_FAIL_COUNT) {
                // é”å®šéªŒè¯
                isLocked = true;
                lockEndTime = Date.now() + LOCK_DURATION * 1000;
                saveCaptchaState(); // ä¿å­˜é”å®šçŠ¶æ€

                if (hint) {
                    hint.innerHTML = `< ss= "lock-message" > éªŒè¯å¤±è´¥æ¬¡æ•°è¿‡å¤š < br > è¯·ç­‰å¾… < span id = "countdown-timer" > ${ LOCK_DURATION }</span> ç§’åé‡è¯•</span > `;
                    hint.style.color = '#ef4444';
                }

                // ç¦ç”¨æ»‘å—
                if (sliderCo                   sliderContainer.style.opacity = '0.5';
                    sliderContainer.style.pointerEvents = 'none';
     

                // å¼€å§‹å€’è®¡æ—¶
                startCountdown();
                return;
               if (hint) {
                hint.textContent = `éªŒè¯å¤±è´¥ï¼Œè¿˜å‰© ${ MAX_FAIL_COUNT - failCount } æ¬¡æœºä¼š`;
                hint.style.color = '#ef4444';
            }

            // æ·»åŠ æŠ–åŠ¨æ•ˆæœ
            piece.style.animation = 'shake 0.5s ease';

            // é‡ç½®ä½ç½®
            setTimeout(() => {
                piece.style.animation = '';
                piece.style.left = '0px';
                thumb.style.left = '2px';
                progress.style.width = '0';
                if (!isLocked) {
                    hint.textContent = 'æ‹–åŠ¨ä¸‹æ–¹æ»‘å—å®Œæˆæ‹¼å›¾';
            hint.style.color = '';
                }
            }, 600);
        }

        function start{
            if (lockTimer) {
                clearInterval(lockTimer);
            }

            lockTimer = setInterval(() => {
                const remaining = Math.ceil((lockEndTime - Date.now()) / 1000);
                const timerEl = document.getElementById('countdown-timer');

                if (remaining <= 0) {
                    // å€’è®¡æ—¶ç»“æŸ
                   al(lockTimer);
                    lockTimer = null;
                    isLocked = false;
                    failCount = 0;
                    lockEndTime = 0;
                    saveCaptchaState(); // ä¿å­˜é‡ç½®åçš„çŠ¶æ€

                    // æ¢å¤æ»‘å—
    const sliderContainer = document.querySelector('.puzzle-slider-container');
                    if (sliderContainer) {
                        sliderContainer.style.opacity = '1';
                        sliderContainer.style.pointerEvents               }

                    // åˆ·æ–°éªŒè¯ç 
                    refreshPuzzle();
                } else if (timerEl) {
                    timerEl.textContent = remaining;
                }
            },}

        function resetPuzzleCaptcha() {
            sliderVerified = false;
            pending= null;
            puzzleTargetX = 0;

            const captchaInput = document.getElementById('captcha-verified');
            const piece = document.getElementByiece');
            const thumb = document.getElementById('puzzle-slider-thumb    const progress = document.getElementById('puzzle-slider-progress');
            const hint = document.getElementById('puzzle-hint');
            const sliderContainer = document.querySelector('.puzzle-slider-container');

            if (captchaInput) captchaInput.value = 'false';
            if (piece) piece.style.left = '0px';
            if (thumb) thumb.style.left = '2px';
            if (prprogress.style.width = '0';
            if (hint) {
                hint.textContent = 'æ‹–åŠ¨ä¸‹æ–¹æ»‘å—å®Œæˆæ‹¼å›¾';
                hint.= '';
            }

            // æ¢å¤æ»‘å—çŠ¶æ€ï¼ˆå¦‚æœä¹‹å‰è¢«ç¦ç”¨ï¼‰
            if (sliderContainer && !isLocked) {
                sliderContainer.style.opacity = '1';
                sliderContainer.style.pointerEve          }
        }

        function refreshPuzzle() {
            // å¦‚æœè¢«é”å®šï¼Œä¸å…è®¸åˆ·æ–°
            if (isLocked) {
                const remaining = Math.ceil((lockEndTime - Date.now()) / 1000);
                if (remaining > 0) {
                    showToast(`è¯·ç­‰å¾… ${ remaining } ç§’åé‡è¯•`, 'error');
                        }
            }
            resetPuzzleCaptcha();
            initPuzzleCaptcha();
        }

        // è‡ªå®šä¹‰æç¤ºæ¡†
        function showToast(message, type = 'info') {
            const toast = document.getElementById('custom-toast');
            const toastMessage = document.getElementById('toast-message');
          document.getElementById('toast-icon');

            if (!toast || !toastMessage) return;

            toastMessage.textContent = message;
            // è®¾ç½®å›¾æ ‡
            if (type === 'success') {
           stIcon.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#10b981" stroke-width="2"><polyline points="20 6 9 17 4 12"               toast.className = 'custom-toast toast-success';
            } else if (type === 'error') {
                toastIcon.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>';
                toast.className = 'custom-toast toast-error';
            } else {
                nerHTML = '<svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="#3b82f6" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>';
                toast.className = 'custom-toast toast-info';
            }

            toast.style.display = 'fle     // è‡ªåŠ¨éšè—
            setTimeout(() => {
                toast.style.display = 'none';
            }, 2500);
        }

        // å­˜å‚¨å¾…æäº¤çš„æ•°æ®
        let pendingThoughtData = null;

        // Submit thought
        astion submitThought(e) {
            e.preventDefault();

            const date = document.getElementById('thought-date').value;
            const category = document.getElementById('thought-category').value;
            const content = document.getElementById('thought-content').value.trim();

            if (!content) {
                showToast('è¯·è¾“å…¥å†…å®¹', 'error');
                return;
            }

    // å¦‚æœæœªéªŒè¯ï¼Œå¼¹å‡ºéªŒè¯æ¡†
            if (!sliderVerified) {
                pendingThoughtData = { date, category, content };
                openPuzzleCaptcha();
                return;
            }

            // å·²éªŒè¯ï¼Œç›´æ¥æäº¤
            await doSubmitThought(date, category, content);
       // å®é™…æäº¤é€»è¾‘
        async function doSubmitThought(ry, content) {
            try {
                const res = await fetch('/api/anonymous-thoughts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date, category, content })
                });

                if (res.ok) {
                    showToast('å‘å¸ƒæˆåŠŸï¼', 'success');
                    closeThoughtModal();
                    // Reload thoughts
                    if (typeof window.loadToolsPageData === 'function') {
                        window.loadToolsPageData();
                    } else {
                        window.location.reload();
                    }
                } else {
                    const data = await res.json();
                    showToast(data.error || 'å‘å¸ƒå¤±è´¥', 'error');
                }
            } catch (err) {
                console.error('Failed to submit thought:', err);
                showToast('å‘å¸ƒå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
            }
        }

        // Initialize thoughts modal evedocument.addEventListener('DOMContentLoaded() {
            // Write button click
            const writeBtn = document.getElementById('write-thought-btn');
            if () {
                writeBtn.addEventListener('click', openTdal);
            }

            // Close button click
            const closeBtn = document.getElemee-thought-modal');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeThoughtModal);
            }

            // Close on backdrop click
            const modal = document.getElementById('thought-modal')  if (modal) {
                modal.addEventListener('click', function (e) {
                    if (e.target =                        closeThoughtModal();
                    }
                });
            }

            // Close on Escape key
            document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') {
                    closeThoughtModal();
                    closePucha();
                }
            });

            // Form submit
            const form = document.getElementById('thought-form');
            if (form) {
                form.addEventListener('submit', submitThought);
            }

            // Puzzle captcha close button
            const puzzleCloseBtn = document.getElementById('puzzle-close-btn');
      CloseBtn) {
                puzzleCloseBtn.addEventListener('click', closePuzzleCaptcha);
            }

            // Puzzle captcha refresh button
            const puzzleRefreshBtn = document.getElementById('puzzle-refresh-btn');
            if (puzzleRefreshBtn) {
                puzzleRefreshBtn.addEventListener('click', refreshPuzzle);
            }

            // Close puzzle modal on backdrop click
            const puzzleModal = document.getElementById('puzzle-captcha-modal');
            if (puzzleModal) {
                puzzleModal.addEventListener('click', function (e) {
                    if (e.target === puzzleModal) {
                        closePuzzleCaptcha();
                    }         });
            }
        });
    </script>

    <!-- Theme Manager -->
    <script src="js/theme-manager.js?v=2026011403"></script>
    <script src="js/tools-ui.js?v=2026011401"></script>
</body>

</html>